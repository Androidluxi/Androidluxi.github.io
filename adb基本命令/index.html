

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lux">
  <meta name="keywords" content="">
  
    <meta name="description" content="一、ADB是什么？adb 称之为：Android 调试桥 （Android Debug Bridge ）是一种允许模拟器或已连接的 Android 设备进行通信的命令行工具，它可为各种设备操作提供便利，如安装和调试应用，并提供对 Unix shell（可用来在模拟器或连接的设备上运行各种命令）的访问。可以在Android SDK&#x2F;platform-tools中找到 adb 工具或下载 ADB Ki">
<meta property="og:type" content="article">
<meta property="og:title" content="adb基本命令">
<meta property="og:url" content="https://tangerine-kitten-lux.netlify.app/adb%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/index.html">
<meta property="og:site_name" content="我的博客">
<meta property="og:description" content="一、ADB是什么？adb 称之为：Android 调试桥 （Android Debug Bridge ）是一种允许模拟器或已连接的 Android 设备进行通信的命令行工具，它可为各种设备操作提供便利，如安装和调试应用，并提供对 Unix shell（可用来在模拟器或连接的设备上运行各种命令）的访问。可以在Android SDK&#x2F;platform-tools中找到 adb 工具或下载 ADB Ki">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.onlinedown.net/download/202306/174942-649d53b6c0d02.jpg">
<meta property="article:published_time" content="2023-10-24T12:39:52.000Z">
<meta property="article:modified_time" content="2025-03-23T15:28:09.910Z">
<meta property="article:author" content="lux">
<meta property="article:tag" content="adb">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.onlinedown.net/download/202306/174942-649d53b6c0d02.jpg">
  
  
  
  <title>adb基本命令 - 我的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css# 鼠标指针.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/toubudaziji.css">
<link rel="stylesheet" href="/css/fluid-extention.css">
<link rel="stylesheet" href="/css/fluid-scroll-bar.css">
<link rel="stylesheet" href="/css/fluid-Navigation-bar-animation.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"tangerine-kitten-lux.netlify.app","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>听闻风起</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="adb基本命令"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-10-24 20:39" pubdate>
          2023年10月24日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          22k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          188 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">adb基本命令</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="一、ADB是什么？"><a href="#一、ADB是什么？" class="headerlink" title="一、ADB是什么？"></a>一、ADB是什么？</h2><p>adb 称之为：Android 调试桥 （<a target="_blank" rel="noopener" href="https://developer.android.com/studio/command-line/adb.html">Android Debug Bridge</a> ）是一种允许模拟器或已连接的 Android 设备进行通信的命令行工具，它可为各种设备操作提供便利，如安装和调试应用，并提供对 <code>Unix shell</code>（可用来在模拟器或连接的设备上运行各种命令）的访问。可以在<code>Android SDK/platform-tools</code>中找到 <code>adb</code> 工具或下载 <a target="_blank" rel="noopener" href="http://adbshell.com/downloads">ADB Kits</a> 。</p>
<p><strong>注：</strong> 有部分命令的支持情况可能与 Android 系统版本及定制 ROM 的实现有关。</p>
<h2 id="二、ADB有什么作用？"><a href="#二、ADB有什么作用？" class="headerlink" title="二、ADB有什么作用？"></a>二、ADB有什么作用？</h2><p><code>ADB</code> 是 <code>Android SDK</code> 里的一个工具, 用这个工具可以直接操作管理Android模拟器或者真实的Android设备。它的主要功能有:</p>
<ul>
<li>在设备上运行Shell命令；</li>
<li>将本地APK软件安装至模拟器或Android设备；</li>
<li>管理设备或手机模拟器上的预定端口；</li>
<li>在设备或手机模拟器上复制或粘贴文件。</li>
</ul>
<p><code>ADB</code> 是一个<code>客户端-服务器程序</code>程序，包括三个组件：</p>
<ul>
<li><strong>客户端</strong>：该组件发送命令。客户端在开发计算机上运行。您可以通过发出 adb 命令从命令行终端调用客户端。</li>
<li><strong>后台程序</strong>：该组件在设备上运行命令。后台程序在每个模拟器或设备实例上作为后台进程运行。</li>
<li><strong>服务器</strong>：该组件管理客户端和后台程序之间的通信。服务器在开发计算机上作为后台进程运行。</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">adb <span class="hljs-built_in">version</span><br></code></pre></td></tr></table></figure>

<h4 id="4-1-2-启动adb"><a href="#4-1-2-启动adb" class="headerlink" title="4.1.2 启动adb"></a>4.1.2 启动adb</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">adb <span class="hljs-keyword">start</span>-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure>

<p>一般无需手动执行此命令，在运行 adb 命令时若发现 adb server 没有启动会自动调起。</p>
<h4 id="4-1-3-停止adb"><a href="#4-1-3-停止adb" class="headerlink" title="4.1.3 停止adb"></a>4.1.3 停止adb</h4><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">adb kill-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure>

<h4 id="4-1-4-以-root-权限运行-adb"><a href="#4-1-4-以-root-权限运行-adb" class="headerlink" title="4.1.4 以 root 权限运行 adb"></a>4.1.4 以 root 权限运行 adb</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adb root</span><br></code></pre></td></tr></table></figure>

<h4 id="4-1-5-指定-adb-server-的网络端口"><a href="#4-1-5-指定-adb-server-的网络端口" class="headerlink" title="4.1.5 指定 adb server 的网络端口"></a>4.1.5 指定 adb server 的网络端口</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">adb -P &lt;port&gt; <span class="hljs-keyword">start</span>-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure>

<p>ADB的默认端口为 5037。</p>
<h4 id="4-1-5-查询已连接的设备-x2F-模拟器列表"><a href="#4-1-5-查询已连接的设备-x2F-模拟器列表" class="headerlink" title="4.1.5 查询已连接的设备&#x2F;模拟器列表"></a>4.1.5 查询已连接的设备&#x2F;模拟器列表</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adb devices</span><br></code></pre></td></tr></table></figure>

<h3 id="4-2-应用管理"><a href="#4-2-应用管理" class="headerlink" title="4.2 应用管理"></a>4.2 应用管理</h3><h4 id="4-2-1-查看应用列表"><a href="#4-2-1-查看应用列表" class="headerlink" title="4.2.1 查看应用列表"></a>4.2.1 查看应用列表</h4><p>查看应用列表的基本命令格式是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">adb shell pm list packages <span class="hljs-selector-attr">[-f]</span> <span class="hljs-selector-attr">[-d]</span> <span class="hljs-selector-attr">[-e]</span> <span class="hljs-selector-attr">[-s]</span> <span class="hljs-selector-attr">[-3]</span> <span class="hljs-selector-attr">[-i]</span> <span class="hljs-selector-attr">[-u]</span> <span class="hljs-selector-attr">[--user USER_ID]</span> <span class="hljs-selector-attr">[FILTER]</span> <br></code></pre></td></tr></table></figure>

<p><code>adb shell pm list packages</code> 后面可以跟一些可选参数进行过滤查看不同的列表，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">显示列表</th>
</tr>
</thead>
<tbody><tr>
<td align="left">无</td>
<td align="left">所有应用</td>
</tr>
<tr>
<td align="left">-f</td>
<td align="left">显示应用关联的 apk 文件</td>
</tr>
<tr>
<td align="left">-d</td>
<td align="left">只显示 disabled 的应用</td>
</tr>
<tr>
<td align="left">-e</td>
<td align="left">只显示 enabled 的应用</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">只显示系统应用</td>
</tr>
<tr>
<td align="left">-3</td>
<td align="left">只显示第三方应用</td>
</tr>
<tr>
<td align="left">-i</td>
<td align="left">显示应用的 installer</td>
</tr>
<tr>
<td align="left">-u</td>
<td align="left">包含已卸载应用</td>
</tr>
<tr>
<td align="left"><code>&lt;filter&gt;</code></td>
<td align="left">包名包含 <code>&lt;filter&gt;</code> 字符串</td>
</tr>
</tbody></table>
<h5 id="4-2-1-1-查看所有应用"><a href="#4-2-1-1-查看所有应用" class="headerlink" title="4.2.1.1 查看所有应用"></a>4.2.1.1 查看所有应用</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> pm list packages</span><br></code></pre></td></tr></table></figure>

<h5 id="4-2-1-2-查看系统应用"><a href="#4-2-1-2-查看系统应用" class="headerlink" title="4.2.1.2 查看系统应用"></a>4.2.1.2 查看系统应用</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> pm list packages -s</span><br></code></pre></td></tr></table></figure>

<h5 id="4-2-1-3-查看第三方应用"><a href="#4-2-1-3-查看第三方应用" class="headerlink" title="4.2.1.3 查看第三方应用"></a>4.2.1.3 查看第三方应用</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell pm list packages -<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<h5 id="4-2-1-4-包名包含某字符串的应用"><a href="#4-2-1-4-包名包含某字符串的应用" class="headerlink" title="4.2.1.4 包名包含某字符串的应用"></a>4.2.1.4 包名包含某字符串的应用</h5><p>比如要查看包名包含字符串 <code>huawei</code> 的应用列表，命令：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> pm list packages huawei</span><br></code></pre></td></tr></table></figure>

<h4 id="4-2-2-安装应用"><a href="#4-2-2-安装应用" class="headerlink" title="4.2.2 安装应用"></a>4.2.2 安装应用</h4><p>安装应用的基本命令格式是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">adb install <span class="hljs-selector-attr">[-l]</span> <span class="hljs-selector-attr">[-r]</span> <span class="hljs-selector-attr">[-t]</span> <span class="hljs-selector-attr">[-s]</span> <span class="hljs-selector-attr">[-d]</span> <span class="hljs-selector-attr">[-g]</span> &lt;apk-file&gt;<br></code></pre></td></tr></table></figure>

<p><code>adb install</code> 后面可以跟一些可选参数来控制安装 APK 的行为，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-l</td>
<td align="left">将应用安装到保护目录 &#x2F;mnt&#x2F;asec</td>
</tr>
<tr>
<td align="left">-r</td>
<td align="left">允许覆盖安装</td>
</tr>
<tr>
<td align="left">-t</td>
<td align="left">允许安装 AndroidManifest.xml 里 application 指定 <code>android:testOnly=&quot;true&quot;</code> 的应用</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">将应用安装到 sdcard</td>
</tr>
<tr>
<td align="left">-d</td>
<td align="left">允许降级覆盖安装</td>
</tr>
<tr>
<td align="left">-g</td>
<td align="left">授予所有运行时权限</td>
</tr>
</tbody></table>
<p>运行命令后可以看到输出内容，包含安装进度和状态，安装状态如下：</p>
<ul>
<li><code>Success</code>：代表安装成功。</li>
<li><code>Failure</code>：代表安装失败。 APK 安装失败的情况有很多，<code>Failure</code>状态之后有安装失败输出代码。常见安装失败输出代码、含义及可能的解决办法如下：</li>
</ul>
<table>
<thead>
<tr>
<th align="left">输出代码</th>
<th align="left">含义</th>
<th align="left">解决办法</th>
</tr>
</thead>
<tbody><tr>
<td align="left">INSTALL_FAILED_ALREADY_EXISTS</td>
<td align="left">应用已经存在，或卸载了但没卸载干净</td>
<td align="left"><code>adb install</code> 时使用 <code>-r</code> 参数，或者先 <code>adb uninstall &lt;packagename&gt;</code> 再安装</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_INVALID_APK</td>
<td align="left">无效的 APK 文件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_INVALID_URI</td>
<td align="left">无效的 APK 文件名</td>
<td align="left">确保 APK 文件名里无中文</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_INSUFFICIENT_STORAGE</td>
<td align="left">空间不足</td>
<td align="left">清理空间</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_DUPLICATE_PACKAGE</td>
<td align="left">已经存在同名程序</td>
<td align="left">public class MyService extends Service {​    private static final String TAG &#x3D; MyService.class.getSimpleName();    private final Messenger mMessenger;​    public MyService() {        &#x2F;&#x2F;创建线程        HandlerThread handlerThread &#x3D; new HandlerThread(“massage_handle”);        handlerThread.start();        mMessenger &#x3D; new Messenger(new MessageHandler(handlerThread.getLooper()));    }​    private class MessageHandler extends Handler {​        public MessageHandler(@NonNull Looper looper) {            super(looper);        }​        @Override        public void handleMessage(@NonNull Message msg) {            switch (msg.what) {                case 1:                    Log.d(TAG, “handleMessage: “ + msg);                    Bundle data &#x3D; msg.getData();                    String msg1 &#x3D; data.getString(“msg”);                    Log.d(TAG, “handleMessage: “ + msg1);                    replyToClient(msg);                    break;                default:                    super.handleMessage(msg);                    break;            }        }    }​​    private void replyToClient(Message msg) {        Messenger replyTo &#x3D; msg.replyTo;        Message obtain &#x3D; Message.obtain(null, 2);        Bundle bundle &#x3D; new Bundle();        bundle.putString(“reply”, “返回的消息!!”);        obtain.setData(bundle);        try {            replyTo.send(obtain);        } catch (RemoteException e) {            e.printStackTrace();        }    }​    @Override    public IBinder onBind(Intent intent) {        return mMessenger.getBinder();​    }}java</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_NO_SHARED_USER</td>
<td align="left">请求的共享用户不存在</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_UPDATE_INCOMPATIBLE</td>
<td align="left">以前安装过同名应用，但卸载时数据没有移除；或者已安装该应用，但签名不一致</td>
<td align="left">先 <code>adb uninstall &lt;packagename&gt;</code> 再安装</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_SHARED_USER_INCOMPATIBLE</td>
<td align="left">请求的共享用户存在但签名不一致</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_MISSING_SHARED_LIBRARY</td>
<td align="left">安装包使用了设备上不可用的共享库</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_REPLACE_COULDNT_DELETE</td>
<td align="left">替换时无法删除</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_DEXOPT</td>
<td align="left">dex 优化验证失败或空间不足</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_OLDER_SDK</td>
<td align="left">设备系统版本低于应用要求</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_CONFLICTING_PROVIDER</td>
<td align="left">设备里已经存在与应用里同名的 content provider</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_NEWER_SDK</td>
<td align="left">设备系统版本高于应用要求</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_TEST_ONLY</td>
<td align="left">应用是 test-only 的，但安装时没有指定 <code>-t</code> 参数</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_CPU_ABI_INCOMPATIBLE</td>
<td align="left">包含不兼容设备 CPU 应用程序二进制接口的 native code</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_MISSING_FEATURE</td>
<td align="left">应用使用了设备不可用的功能</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_CONTAINER_ERROR</td>
<td align="left">1. sdcard 访问失败; 2. 应用签名与 ROM 签名一致，被当作内置应用。</td>
<td align="left">1. 确认 sdcard 可用，或者安装到内置存储; 2. 打包时不与 ROM 使用相同签名。</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_INVALID_INSTALL_LOCATION</td>
<td align="left">1. 不能安装到指定位置; 2. 应用签名与 ROM 签名一致，被当作内置应用。</td>
<td align="left">1. 切换安装位置，添加或删除 <code>-s</code> 参数; 2. 打包时不与 ROM 使用相同签名。</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_MEDIA_UNAVAILABLE</td>
<td align="left">安装位置不可用</td>
<td align="left">一般为 sdcard，确认 sdcard 可用或安装到内置存储</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_VERIFICATION_TIMEOUT</td>
<td align="left">验证安装包超时</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_VERIFICATION_FAILURE</td>
<td align="left">验证安装包失败</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_PACKAGE_CHANGED</td>
<td align="left">应用与调用程序期望的不一致</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_UID_CHANGED</td>
<td align="left">以前安装过该应用，与本次分配的 UID 不一致</td>
<td align="left">清除以前安装过的残留文件</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_VERSION_DOWNGRADE</td>
<td align="left">已经安装了该应用更高版本</td>
<td align="left">使用 <code>-d</code> 参数</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_PERMISSION_MODEL_DOWNGRADE</td>
<td align="left">已安装 target SDK 支持运行时权限的同名应用，要安装的版本不支持运行时权限</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_NOT_APK</td>
<td align="left">指定路径不是文件，或不是以 <code>.apk</code> 结尾</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_BAD_MANIFEST</td>
<td align="left">无法解析的 AndroidManifest.xml 文件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_UNEXPECTED_EXCEPTION</td>
<td align="left">解析器遇到异常</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_NO_CERTIFICATES</td>
<td align="left">安装包没有签名</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES</td>
<td align="left">已安装该应用，且签名与 APK 文件不一致</td>
<td align="left">先卸载设备上的该应用，再安装</td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING</td>
<td align="left">解析 APK 文件时遇到 <code>CertificateEncodingException</code></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_BAD_PACKAGE_NAME</td>
<td align="left">manifest 文件里没有或者使用了无效的包名</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_BAD_SHARED_USER_ID</td>
<td align="left">manifest 文件里指定了无效的共享用户 ID</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_MANIFEST_MALFORMED</td>
<td align="left">解析 manifest 文件时遇到结构性错误</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_PARSE_FAILED_MANIFEST_EMPTY</td>
<td align="left">在 manifest 文件里找不到找可操作标签（instrumentation 或 application）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_INTERNAL_ERROR</td>
<td align="left">因系统问题安装失败</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_USER_RESTRICTED</td>
<td align="left">用户被限制安装应用</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_DUPLICATE_PERMISSION</td>
<td align="left">应用尝试定义一个已经存在的权限名称</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_NO_MATCHING_ABIS</td>
<td align="left">应用包含设备的应用程序二进制接口不支持的 native code</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_CANCELED_BY_USER</td>
<td align="left">应用安装需要在设备上确认，但未操作设备或点了取消</td>
<td align="left">在设备上同意安装</td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_ACWF_INCOMPATIBLE</td>
<td align="left">应用程序与设备不兼容</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">INSTALL_FAILED_TEST_ONLY</td>
<td align="left">APK 文件是使用 Android Studio 直接 RUN 编译出来的文件</td>
<td align="left">通过 Gradle 的 assembleDebug 或 assembleRelease 重新编译，或者 Generate Signed APK</td>
</tr>
<tr>
<td align="left">does not contain AndroidManifest.xml</td>
<td align="left">无效的 APK 文件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">is not a valid zip file</td>
<td align="left">无效的 APK 文件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Offline</td>
<td align="left">设备未连接成功</td>
<td align="left">先将设备与 adb 连接成功</td>
</tr>
<tr>
<td align="left">unauthorized</td>
<td align="left">设备未授权允许调试</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">error: device not found</td>
<td align="left">没有连接成功的设备</td>
<td align="left">先将设备与 adb 连接成功</td>
</tr>
<tr>
<td align="left">protocol failure</td>
<td align="left">设备已断开连接</td>
<td align="left">先将设备与 adb 连接成功</td>
</tr>
<tr>
<td align="left">Unknown option: -s</td>
<td align="left">Android 2.2 以下不支持安装到 sdcard</td>
<td align="left">不使用 <code>-s</code> 参数</td>
</tr>
<tr>
<td align="left">No space left on device</td>
<td align="left">空间不足</td>
<td align="left">清理空间</td>
</tr>
<tr>
<td align="left">Permission denied … sdcard …</td>
<td align="left">sdcard 不可用</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">signatures do not match the previously installed version; ignoring!</td>
<td align="left">已安装该应用且签名不一致</td>
<td align="left">先卸载设备上的该应用，再安装</td>
</tr>
</tbody></table>
<p>参考：<a target="_blank" rel="noopener" href="https://github.com/android/platform_frameworks_base/blob/master/core%2Fjava%2Fandroid%2Fcontent%2Fpm%2FPackageManager.java">PackageManager.java</a></p>
<p><code>adb install</code> 实际是分三步完成：</p>
<ol>
<li>push apk 文件到 &#x2F;data&#x2F;local&#x2F;tmp。</li>
<li>调用 pm install 安装。</li>
<li>删除 &#x2F;data&#x2F;local&#x2F;tmp 下的对应 apk 文件。</li>
</ol>
<h4 id="4-2-3-卸载应用"><a href="#4-2-3-卸载应用" class="headerlink" title="4.2.3 卸载应用"></a>4.2.3 卸载应用</h4><p>卸载应用的基本命令格式是：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">adb uninstall [-k] &lt;<span class="hljs-keyword">package</span>-name&gt;<br></code></pre></td></tr></table></figure>

<p><code>&lt;package-name&gt;</code> 表示应用的包名，<code>-k</code> 参数可选，表示卸载应用但保留数据和缓存目录。</p>
<h4 id="4-2-4-清除应用数据与缓存"><a href="#4-2-4-清除应用数据与缓存" class="headerlink" title="4.2.4 清除应用数据与缓存"></a>4.2.4 清除应用数据与缓存</h4><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">adb <span class="hljs-built_in">shell</span> pm <span class="hljs-keyword">clear</span> &lt;package-name&gt;<br></code></pre></td></tr></table></figure>

<p><code>&lt;package-name&gt;</code> 表示应用名包，这条命令的效果相当于在设置里的应用信息界面点击了「清除缓存」和「清除数据」。</p>
<h4 id="4-2-5-查看前台-Activity"><a href="#4-2-5-查看前台-Activity" class="headerlink" title="4.2.5 查看前台 Activity"></a>4.2.5 查看前台 Activity</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> dumpsys activity activities | <span class="hljs-keyword">grep</span> mFocusedActivity<br></code></pre></td></tr></table></figure>

<h4 id="4-2-6-查看正在运行的-Services"><a href="#4-2-6-查看正在运行的-Services" class="headerlink" title="4.2.6 查看正在运行的 Services"></a>4.2.6 查看正在运行的 Services</h4><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">adb shell dumpsys activity services <span class="hljs-meta">[&lt;package-name&gt;]</span><br></code></pre></td></tr></table></figure>

<p><code>&lt;package-name&gt;</code> 参数不是必须的，指定 <code>&lt;package-name&gt;</code> 表示查看与某个包名相关的 Services，不指定表示查看所有 Services。<code>&lt;package-name&gt;</code> 不一定要给出完整的包名，可以只给一部分，那么所给包名相关的 Services 都会列出来。</p>
<h4 id="4-2-7-查看应用详细信息"><a href="#4-2-7-查看应用详细信息" class="headerlink" title="4.2.7 查看应用详细信息"></a>4.2.7 查看应用详细信息</h4><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">adb shell dumpsys <span class="hljs-keyword">package</span> <span class="hljs-title">&lt;<span class="hljs-keyword">package</span>-name&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>&lt;package-name&gt;</code> 表示应用包名。运行次命令的输出中包含很多信息，包括 Activity Resolver Table、Registered ContentProviders、包名、userId、安装后的文件资源代码等路径、版本信息、权限信息和授予状态、签名版本信息等。</p>
<h4 id="4-2-7-查看应用安装路径"><a href="#4-2-7-查看应用安装路径" class="headerlink" title="4.2.7 查看应用安装路径"></a>4.2.7 查看应用安装路径</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">adb shell pm <span class="hljs-built_in">path</span> &lt;<span class="hljs-built_in">package</span>-name&gt;<br></code></pre></td></tr></table></figure>

<h3 id="4-3-与应用交互"><a href="#4-3-与应用交互" class="headerlink" title="4.3 与应用交互"></a>4.3 与应用交互</h3><p>与应用交互主要是使用 <code>am &lt;command&gt;</code> 命令，常用的 <code>&lt;command&gt;</code> 如下：</p>
<table>
<thead>
<tr>
<th align="left">command</th>
<th align="left">用途</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>start [options] &lt;intent&gt;</code></td>
<td align="left">启动 <code>&lt;intent&gt;</code> 指定的 Activity</td>
</tr>
<tr>
<td align="left"><code>startservice [options] &lt;intent&gt;</code></td>
<td align="left">启动 <code>&lt;intent&gt;</code> 指定的 Service</td>
</tr>
<tr>
<td align="left"><code>broadcast [options] &lt;intent&gt;</code></td>
<td align="left">发送 <code>&lt;intent&gt;</code> 指定的广播</td>
</tr>
<tr>
<td align="left"><code>force-stop &lt;package-name&gt;</code></td>
<td align="left">停止 <code>&lt;package-name&gt;</code> 相关的进程</td>
</tr>
</tbody></table>
<p><code>&lt;intent&gt;</code> 参数很灵活，和写 Android 程序时代码里的 Intent 相对应。</p>
<p>用于决定 intent 对象的选项如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-a &lt;action&gt;</code></td>
<td align="left">指定 action，比如 <code>android.intent.action.VIEW</code></td>
</tr>
<tr>
<td align="left"><code>-c &lt;category&gt;</code></td>
<td align="left">指定 category，比如 <code>android.intent.category.APP_CONTACTS</code></td>
</tr>
<tr>
<td align="left"><code>-n &lt;component&gt;</code></td>
<td align="left">指定完整 component 名，用于明确指定启动哪个 Activity</td>
</tr>
</tbody></table>
<p><code>&lt;intent&gt;</code> 里还能带数据，就像写代码时的 Bundle 一样：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>--esn &lt;extra-key&gt;</code></td>
<td align="left">null 值(只有 key 名)</td>
</tr>
<tr>
<td align="left">&#96;-e</td>
<td align="left">–es <extra-key> <extra-string-value>&#96;</extra-string-value></extra-key></td>
</tr>
<tr>
<td align="left"><code>--ez &lt;extra-key&gt; &lt;extra-boolean-value&gt;</code></td>
<td align="left">boolean 值</td>
</tr>
<tr>
<td align="left"><code>--ei &lt;extra-key&gt; &lt;extra-int-value&gt;</code></td>
<td align="left">integer 值</td>
</tr>
<tr>
<td align="left"><code>--el &lt;extra-key&gt; &lt;extra-long-value&gt;</code></td>
<td align="left">long 值</td>
</tr>
<tr>
<td align="left"><code>--ef &lt;extra-key&gt; &lt;extra-float-value&gt;</code></td>
<td align="left">float 值</td>
</tr>
<tr>
<td align="left"><code>--eu &lt;extra-key&gt; &lt;extra-uri-value&gt;</code></td>
<td align="left">URI</td>
</tr>
<tr>
<td align="left"><code>--ecn &lt;extra-key&gt; &lt;extra-component-name-value&gt;</code></td>
<td align="left">component name</td>
</tr>
<tr>
<td align="left"><code>--eia &lt;extra-key&gt; &lt;extra-int-value&gt;[,&lt;extra-int-value...]</code></td>
<td align="left">integer 数组</td>
</tr>
<tr>
<td align="left"><code>--ela &lt;extra-key&gt; &lt;extra-long-value&gt;[,&lt;extra-long-value...]</code></td>
<td align="left">long 数组</td>
</tr>
</tbody></table>
<h4 id="4-3-1-启动应用-x2F-调起-Activity"><a href="#4-3-1-启动应用-x2F-调起-Activity" class="headerlink" title="4.3.1 启动应用&#x2F; 调起 Activity"></a>4.3.1 启动应用&#x2F; 调起 Activity</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> start [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;intent&gt;</span><br></code></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell am start -a android.settings.SETTINGS                   # 打开系统设置页面<br>adb shell am start -a android.intent.action.DIAL -d tel:10086     # 打开拨号页面<br>adb shell am start -n com.android.mms/.ui.ConversationList        # 打开短信会话列表<br></code></pre></td></tr></table></figure>

<p>options 是一些改变其行为的选项，支持的可选参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-D</td>
<td align="left">启用调试</td>
</tr>
<tr>
<td align="left">-W</td>
<td align="left">等待启动完成</td>
</tr>
<tr>
<td align="left">–start-profiler <code>file</code></td>
<td align="left">启动分析器并将结果发送到 <code>file</code></td>
</tr>
<tr>
<td align="left">-P <code>file</code></td>
<td align="left">类似于 –start-profiler，但当应用进入空闲状态时分析停止</td>
</tr>
<tr>
<td align="left">-R <code>count</code></td>
<td align="left">重复 Activity 启动次数</td>
</tr>
<tr>
<td align="left">-S</td>
<td align="left">启动 Activity 前强行停止目标应用</td>
</tr>
<tr>
<td align="left">–opengl-trace</td>
<td align="left">启用 OpenGL 函数的跟踪</td>
</tr>
<tr>
<td align="left">–user <code>user_id</code> | current</td>
<td align="left">指定要作为哪个用户运行；如果未指定，则作为当前用户运行</td>
</tr>
</tbody></table>
<h4 id="4-3-2-调起-Service"><a href="#4-3-2-调起-Service" class="headerlink" title="4.3.2 调起 Service"></a>4.3.2 调起 Service</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> startservice [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;intent&gt;</span><br></code></pre></td></tr></table></figure>

<p>一个典型的用例是如果设备上原本应该显示虚拟按键但是没有显示，可以试试这个：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> startservice -n <span class="hljs-keyword">com</span>.android.systemui/.SystemUIService<br></code></pre></td></tr></table></figure>

<h4 id="4-3-3-停止-Service"><a href="#4-3-3-停止-Service" class="headerlink" title="4.3.3 停止 Service"></a>4.3.3 停止 Service</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> stopservice [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;intent&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="4-3-4-强制停止应用"><a href="#4-3-4-强制停止应用" class="headerlink" title="4.3.4 强制停止应用"></a>4.3.4 强制停止应用</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">am</span> force-<span class="hljs-keyword">stop</span> <span class="hljs-symbol">&lt;packagename&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="4-4-文件管理"><a href="#4-4-文件管理" class="headerlink" title="4.4 文件管理"></a>4.4 文件管理</h3><h4 id="4-4-1-从模拟器-x2F-设备下载指定的文件到计算机"><a href="#4-4-1-从模拟器-x2F-设备下载指定的文件到计算机" class="headerlink" title="4.4.1 从模拟器&#x2F;设备下载指定的文件到计算机"></a>4.4.1 从模拟器&#x2F;设备下载指定的文件到计算机</h4><p>从模拟器&#x2F;设备下载指定的文件到计算机的基本命令格式是：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> pull &lt;remote&gt;<span class="hljs-meta"> [local]</span><br></code></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>remote</code>: 模拟器&#x2F;设备里的文件路径</li>
<li><code>local</code>:计算机上的目录，参数可以省略，默认复制到当前目录</li>
</ul>
<p>例如，将 &#x2F;sdcard&#x2F;yibijizhang.apk 下载到计算机的当前目录：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb pull <span class="hljs-regexp">/sdcard/yi</span>bijizhang.apk<br></code></pre></td></tr></table></figure>

<p>将 &#x2F;sdcard&#x2F;yibijizhang.apk 下载到计算机的当前目录(目录需存在)：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb pull <span class="hljs-regexp">/sdcard/yi</span>bijizhang.apk D:\Download<br></code></pre></td></tr></table></figure>

<h4 id="4-4-2-将指定的文件从计算机上传到模拟器-x2F-设备"><a href="#4-4-2-将指定的文件从计算机上传到模拟器-x2F-设备" class="headerlink" title="4.4.2 将指定的文件从计算机上传到模拟器&#x2F;设备"></a>4.4.2 将指定的文件从计算机上传到模拟器&#x2F;设备</h4><p>将指定的文件从计算机上传到模拟器&#x2F;设备的基本命令格式是：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">adb push <span class="hljs-tag">&lt;<span class="hljs-name">local</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">remote</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>参数说明：</p>
<ul>
<li><code>local</code>:计算机上的文件路径</li>
<li><code>remote</code>: 模拟器&#x2F;设备里的目录</li>
</ul>
<p>例如，将 D:\Download\</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">adb push <span class="hljs-tag">&lt;<span class="hljs-name">local</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">remote</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>下载到设备的&#x2F;sdcard&#x2F;music&#x2F;目录：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">adb <span class="hljs-built_in">push</span> D:\Download\<br>adb <span class="hljs-built_in">push</span> &lt;local&gt; &lt;remote&gt;<br><span class="hljs-regexp">/sdcard/mu</span>sic/ <br></code></pre></td></tr></table></figure>

<h4 id="4-4-4-列出指定目录的内容"><a href="#4-4-4-列出指定目录的内容" class="headerlink" title="4.4.4 列出指定目录的内容"></a>4.4.4 列出指定目录的内容</h4><p>列出模拟器&#x2F;设备上指定目录的内容的基本命令格式是：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">ls</span> [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;directory&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>&lt;directory&gt;</code> 表示指定目录，可以省略，表示列出根目录下的所有文件和目录。 <code>adb shell ls</code> 后面可以跟一些可选参数进行过滤查看不同的列表，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">显示列表</th>
</tr>
</thead>
<tbody><tr>
<td align="left">无</td>
<td align="left">列出目录下的所有文件和目录</td>
</tr>
<tr>
<td align="left">-a</td>
<td align="left">列出目录下的所有文件(包括隐藏的)</td>
</tr>
<tr>
<td align="left">-i</td>
<td align="left">列出目录下的所有文件和索引编号</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">列出目录下的所有文件和文件大小</td>
</tr>
<tr>
<td align="left">-n</td>
<td align="left">列出目录下的所有文件及其 UID和 GID</td>
</tr>
<tr>
<td align="left">-R</td>
<td align="left">列出目录下的所有子目录中的文件</td>
</tr>
</tbody></table>
<h4 id="4-4-5-切换到目标目录"><a href="#4-4-5-切换到目标目录" class="headerlink" title="4.4.5 切换到目标目录"></a>4.4.5 切换到目标目录</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">cd</span> <span class="hljs-symbol">&lt;directory&gt;</span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>cd &lt;directory&gt;</code>命令切换到目标目录。</p>
<h4 id="4-4-6-删除文件或目录"><a href="#4-4-6-删除文件或目录" class="headerlink" title="4.4.6 删除文件或目录"></a>4.4.6 删除文件或目录</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">adb <span class="hljs-built_in">shell</span> rm [options] &lt;<span class="hljs-built_in">files</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">directory</span>&gt;<br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>rm [options] &lt;files or directory&gt;</code>命令删除文件或目录。</p>
<p><code>rm</code> 后面可以跟一些可选参数进行不同的操作，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">无</td>
<td align="left">删除文件</td>
</tr>
<tr>
<td align="left">-f</td>
<td align="left">强制删除文件，系统不提示</td>
</tr>
<tr>
<td align="left">-r</td>
<td align="left">强制删除指定目录中的所有文件和子目录</td>
</tr>
<tr>
<td align="left">-d</td>
<td align="left">删除指定目录，即使它是一个非空目录</td>
</tr>
<tr>
<td align="left">-i</td>
<td align="left">交互式删除，删除前提示</td>
</tr>
</tbody></table>
<p><code>rm -d</code> 等同于 <code>rmdir</code> 命令，有些版本不包含<code>-d</code> 参数。</p>
<h4 id="4-4-7-创建目录"><a href="#4-4-7-创建目录" class="headerlink" title="4.4.7 创建目录"></a>4.4.7 创建目录</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-built_in">mkdir</span> [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;directory-name&gt;</span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>mkdir [options] &lt;directory-name&gt;</code>命令创建目录。 <code>mkdir</code> 后面可以跟一些可选参数进行不同的操作，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">无</td>
<td align="left">创建指定目录</td>
</tr>
<tr>
<td align="left">-m</td>
<td align="left">创建指定目录并赋予读写权限</td>
</tr>
<tr>
<td align="left">-p</td>
<td align="left">创建指定目录及其父目录</td>
</tr>
</tbody></table>
<h4 id="4-4-8-创建空文件或改变文件时间戳"><a href="#4-4-8-创建空文件或改变文件时间戳" class="headerlink" title="4.4.8 创建空文件或改变文件时间戳"></a>4.4.8 创建空文件或改变文件时间戳</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> touch [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;file&gt;</span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>touch [options] &lt;file&gt;</code>命令创建空文件或改变文件时间戳。</p>
<p>可通过<code>ls -n &lt;directory&gt;</code> 命令查看文件的时间。</p>
<h4 id="4-4-9-输出当前目录路径"><a href="#4-4-9-输出当前目录路径" class="headerlink" title="4.4.9 输出当前目录路径"></a>4.4.9 输出当前目录路径</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> <span class="hljs-built_in">pwd</span></span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>pwd</code>命令输出当前目录路径。</p>
<h4 id="4-4-10-复制文件和目录"><a href="#4-4-10-复制文件和目录" class="headerlink" title="4.4.10 复制文件和目录"></a>4.4.10 复制文件和目录</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">cp</span> [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;source&gt;</span> <span class="hljs-symbol">&lt;dest&gt;</span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>cp [options] &lt;source&gt; &lt;dest&gt;</code>命令复制文件和目录。 参数说明：</p>
<ul>
<li><code>source</code>:源文件路径</li>
<li><code>dest</code>: 目标文件路径</li>
</ul>
<h4 id="4-4-11-移动或重命名文件"><a href="#4-4-11-移动或重命名文件" class="headerlink" title="4.4.11 移动或重命名文件"></a>4.4.11 移动或重命名文件</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> mv [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;source&gt;</span> <span class="hljs-symbol">&lt;dest&gt;</span><br></code></pre></td></tr></table></figure>

<p>第一步：执行<code>adb shell</code>命令； 第二步：执行<code>mv [options] &lt;source&gt; &lt;dest&gt;</code>命令移动或重命名文件。 参数说明：</p>
<ul>
<li><code>source</code>:源文件路径</li>
<li><code>dest</code>: 目标文件路径</li>
</ul>
<h3 id="4-5-网络管理"><a href="#4-5-网络管理" class="headerlink" title="4.5 网络管理"></a>4.5 网络管理</h3><h4 id="4-5-1-查看网络统计信息"><a href="#4-5-1-查看网络统计信息" class="headerlink" title="4.5.1 查看网络统计信息"></a>4.5.1 查看网络统计信息</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> netstat</span><br></code></pre></td></tr></table></figure>

<p>也可以将网络统计信息输出到指定文件：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">adb <span class="hljs-built_in">shell</span> netstat&gt;&lt;<span class="hljs-built_in">file</span>-path&gt;<br></code></pre></td></tr></table></figure>

<p>例如，可以通过 <code>adb shell netstat&gt;D:\netstat.log</code> 将日志输出到 <code>D:\netstat.log</code> 中。</p>
<h4 id="4-5-2-测试两个网络间的连接和延迟"><a href="#4-5-2-测试两个网络间的连接和延迟" class="headerlink" title="4.5.2 测试两个网络间的连接和延迟"></a>4.5.2 测试两个网络间的连接和延迟</h4><p><code>ping</code> 命令的格式如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell ping [-aAbBdDfhLnOqrRUvV] [-c count] [-i interval] [-I interface]<br>[-m mark] [-M pmtudisc_option] [-l preload] [-p pattern] [-Q tos]<br>[-s packetsize] [-S sndbuf] [-t ttl] [-T timestamp_option]<br>[-w deadline] [-W timeout] [hop1 ...] destination<br>复制代码<br></code></pre></td></tr></table></figure>

<p>例如，ping一个域名：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> ping www.baidu.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure>

<p>不结束的话会一直ping下去，可以按 <code>Ctrl + C</code> 停止ping操作。</p>
<p>也可以指定ping的次数：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> ping -<span class="hljs-keyword">c</span> <span class="hljs-number">4</span> www.baidu.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure>

<h4 id="4-5-3-通过配置文件配置和管理网络连接"><a href="#4-5-3-通过配置文件配置和管理网络连接" class="headerlink" title="4.5.3 通过配置文件配置和管理网络连接"></a>4.5.3 通过配置文件配置和管理网络连接</h4><p><code>netcfg</code> 命令的格式如下：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">adb shell netcfg [<span class="hljs-variable">&lt;interface&gt;</span> &#123;dhcp|<span class="hljs-string">up</span>|<span class="hljs-string">down&#125;]</span><br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">rmnet_ims10 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_ims00 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun04 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun03 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun02 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun01 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun00 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun14 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun13 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun12 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun11 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_tun10 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet1   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet0   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet4   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet3   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet2   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet6   DOWN                                   0.0.0.0/0   0x00001002<br>rmnet5   DOWN                                   0.0.0.0/0   0x00001002<br>dummy0   UP                                     0.0.0.0/0   0x000000c3<br>rmnet_r_ims10 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_r_ims00 DOWN                                   0.0.0.0/0   0x00001002<br>rmnet_emc0 DOWN                                   0.0.0.0/0   0x00001002<br>lo       UP                                   127.0.0.1/8   0x00000049<br>sit0     DOWN                                   0.0.0.0/0   0x00000080<br>wlan0    UP                                 10.0.38.176/23  0x00001043<br>复制代码<br></code></pre></td></tr></table></figure>

<h4 id="4-5-4-显示、操作路由、设备、策略路由和隧道"><a href="#4-5-4-显示、操作路由、设备、策略路由和隧道" class="headerlink" title="4.5.4 显示、操作路由、设备、策略路由和隧道"></a>4.5.4 显示、操作路由、设备、策略路由和隧道</h4><p><code>ip</code> 命令的格式如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">adb shell ip <span class="hljs-selector-attr">[ options ]</span> <span class="hljs-selector-tag">object</span><br></code></pre></td></tr></table></figure>

<ul>
<li>options :&#x3D; { -V[ersion] | -s[tatistics] | -d[etails] | -r[esolve] |-f[amily] { inet | inet6 | ipx | dnet | link } |-l[oops] { maximum-addr-flush-attempts } |-o[neline] | -t[imestamp] | -b[atch] [filename] |-rc[vbuf] [size]}</li>
<li>object :&#x3D; { link | addr | addrlabel | route | rule | neigh | ntable |tunnel | tuntap | maddr | mroute | mrule | monitor | xfrm |netns | l2tp }</li>
</ul>
<p><code>options</code> 是一些修改ip行为或者改变其输出的选项。所有的选项都是以-字符开头，分为长、短两种形式，支持的可选参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-V,-Version</td>
<td align="left">打印ip的版本并退出</td>
</tr>
<tr>
<td align="left">-s,-stats,-statistics</td>
<td align="left">输出更为详尽的信息(如果这个选项出现两次或者多次，输出的信息将更为详尽)</td>
</tr>
<tr>
<td align="left">-f,-family</td>
<td align="left">强调使用的协议种类(包括：inet、inet6或者link)</td>
</tr>
<tr>
<td align="left">-4</td>
<td align="left">是-family inet的简写</td>
</tr>
<tr>
<td align="left">-6</td>
<td align="left">是-family inet6的简写</td>
</tr>
<tr>
<td align="left">-0</td>
<td align="left">是-family link的简写</td>
</tr>
<tr>
<td align="left">-o,-oneline</td>
<td align="left">对每行记录都使用单行输出，回行用字符代替</td>
</tr>
<tr>
<td align="left">-r,-resolve</td>
<td align="left">查询域名解析系统，用获得的主机名代替主机IP地址</td>
</tr>
</tbody></table>
<p><code>object</code> 是你要管理或者获取信息的对象。目前ip认识的对象包括：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">显示列表</th>
</tr>
</thead>
<tbody><tr>
<td align="left">link</td>
<td align="left">网络设备</td>
</tr>
<tr>
<td align="left">address</td>
<td align="left">一个设备的协议(IP或者IPV6)地址</td>
</tr>
<tr>
<td align="left">neighbour</td>
<td align="left">ARP或者NDISC缓冲区条目</td>
</tr>
<tr>
<td align="left">route</td>
<td align="left">路由表条目</td>
</tr>
<tr>
<td align="left">rule</td>
<td align="left">路由策略数据库中的规则</td>
</tr>
<tr>
<td align="left">maddress</td>
<td align="left">多播地址</td>
</tr>
<tr>
<td align="left">mroute</td>
<td align="left">多播路由缓冲区条目</td>
</tr>
<tr>
<td align="left">tuntap</td>
<td align="left">管理 TUN&#x2F;TAP 设备</td>
</tr>
<tr>
<td align="left">netns</td>
<td align="left">管理网络空间</td>
</tr>
</tbody></table>
<p>例如，查看 <code>WiFi IP</code> 地址：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">adb <span class="hljs-keyword">shell </span>ip -f inet <span class="hljs-keyword">addr </span><span class="hljs-keyword">show </span>wlan0<br></code></pre></td></tr></table></figure>

<h3 id="4-6日志打印"><a href="#4-6日志打印" class="headerlink" title="4.6日志打印"></a>4.6日志打印</h3><p>Android 系统的日志分为两部分，底层的 Linux 内核日志输出到 &#x2F;proc&#x2F;kmsg，Android 的日志输出到 &#x2F;dev&#x2F;log。</p>
<h4 id="4-6-1-Android-日志"><a href="#4-6-1-Android-日志" class="headerlink" title="4.6.1 Android 日志"></a>4.6.1 Android 日志</h4><p>查看 Android 设备系统属性的基本命令格式是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">adb logcat <span class="hljs-selector-attr">[option]</span> <span class="hljs-selector-attr">[filter-specs]</span><br></code></pre></td></tr></table></figure>

<p>如果需要停止 <code>logcat</code> 日志打印，可以按 <code>Ctrl + C</code> 停止日志监控。</p>
<h5 id="4-6-1-1-按级别过滤日志"><a href="#4-6-1-1-按级别过滤日志" class="headerlink" title="4.6.1.1 按级别过滤日志"></a>4.6.1.1 按级别过滤日志</h5><p>按级别过滤日志的基本命令格式是：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> logcat<span class="hljs-meta"> [filter-specs]</span><br></code></pre></td></tr></table></figure>

<p>Android 的日志分为如下几个优先级（priority）：</p>
<table>
<thead>
<tr>
<th align="left">级别</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">*:V</td>
<td align="left">过滤只显示 Verbose 及以上级别(优先级最低)</td>
</tr>
<tr>
<td align="left">*:D</td>
<td align="left">过滤只显示 Debug 及以上级别</td>
</tr>
<tr>
<td align="left">*:I</td>
<td align="left">过滤只显示 Info 及以上级别</td>
</tr>
<tr>
<td align="left">*:W</td>
<td align="left">过滤只显示 Warning 及以上级别</td>
</tr>
<tr>
<td align="left">*:E</td>
<td align="left">过滤只显示 Error 及以上级别</td>
</tr>
<tr>
<td align="left">*:F</td>
<td align="left">过滤只显示 Fatal 及以上级别</td>
</tr>
<tr>
<td align="left">*:S</td>
<td align="left">过滤只显示 Silent 及以上级别(优先级最高，什么也不输出)</td>
</tr>
</tbody></table>
<p>按某级别过滤日志则会将该级别及以上的日志输出。</p>
<p>比如，命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat *:W<br>复制代码<br></code></pre></td></tr></table></figure>

<p>会将 Warning、Error、Fatal 和 Silent 日志输出。</p>
<p>（<strong>注：</strong> 在 macOS 下需要给 <code>*:W</code> 这样以 <code>*</code> 作为 tag 的参数加双引号，如 <code>adb logcat &quot;*:W&quot;</code>，不然会报错 <code>no matches found: *:W</code>。）</p>
<h5 id="4-7-1-2-按-tag-和级别过滤日志"><a href="#4-7-1-2-按-tag-和级别过滤日志" class="headerlink" title="4.7.1.2 按 tag 和级别过滤日志"></a>4.7.1.2 按 tag 和级别过滤日志</h5><p>按 tag 和级别过滤日志的基本命令格式是：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat [tag:level] [tag:level] ...<br>复制代码<br></code></pre></td></tr></table></figure>

<p>比如，命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat ActivityManager:I MyApp:D *:S<br>复制代码<br></code></pre></td></tr></table></figure>

<p>表示输出 tag <code>ActivityManager</code> 的 Info 以上级别日志，输出 tag <code>MyApp</code> 的 Debug 以上级别日志，及其它 tag 的 Silent 级别日志（即屏蔽其它 tag 日志）。</p>
<h5 id="4-6-1-3-将日志格式化输出"><a href="#4-6-1-3-将日志格式化输出" class="headerlink" title="4.6.1.3 将日志格式化输出"></a>4.6.1.3 将日志格式化输出</h5><p>可以用 <code>adb logcat -v &lt;format&gt;</code> 选项指定日志输出格式。</p>
<p>日志支持按以下几种 <code>&lt;format&gt;</code>：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">显示格式</th>
</tr>
</thead>
<tbody><tr>
<td align="left">brief</td>
<td align="left"><code>&lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">process</td>
<td align="left"><code>&lt;priority&gt;(&lt;pid&gt;) &lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">tag</td>
<td align="left"><code>&lt;priority&gt;/&lt;tag&gt;: &lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">raw</td>
<td align="left"><code>&lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">time</td>
<td align="left"><code>&lt;datetime&gt; &lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">threadtime</td>
<td align="left"><code>&lt;datetime&gt; &lt;pid&gt; &lt;tid&gt; &lt;priority&gt; &lt;tag&gt;: &lt;message&gt;</code></td>
</tr>
<tr>
<td align="left">long</td>
<td align="left"><code>[ &lt;datetime&gt; &lt;pid&gt;:&lt;tid&gt; &lt;priority&gt;/&lt;tag&gt; ] &lt;message&gt;</code></td>
</tr>
</tbody></table>
<p>日志格式默认为 <code>brief</code>，指定格式可与上面的过滤同时使用。比如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -v long ActivityManager:I *:S<br>复制代码<br></code></pre></td></tr></table></figure>

<h5 id="4-6-1-3-清空已存在的日志"><a href="#4-6-1-3-清空已存在的日志" class="headerlink" title="4.6.1.3 清空已存在的日志"></a>4.6.1.3 清空已存在的日志</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -c<br>复制代码<br></code></pre></td></tr></table></figure>

<h5 id="4-6-1-4-将日志显示在控制台"><a href="#4-6-1-4-将日志显示在控制台" class="headerlink" title="4.6.1.4 将日志显示在控制台"></a>4.6.1.4 将日志显示在控制台</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -d<br>复制代码<br></code></pre></td></tr></table></figure>

<h5 id="4-6-1-5-将日志输出到文件"><a href="#4-6-1-5-将日志输出到文件" class="headerlink" title="4.6.1.5 将日志输出到文件"></a>4.6.1.5 将日志输出到文件</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -f &lt;file-path&gt;<br>复制代码<br></code></pre></td></tr></table></figure>

<h5 id="4-6-1-6-加载一个可使用的日志缓冲区供查看"><a href="#4-6-1-6-加载一个可使用的日志缓冲区供查看" class="headerlink" title="4.6.1.6 加载一个可使用的日志缓冲区供查看"></a>4.6.1.6 加载一个可使用的日志缓冲区供查看</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -b &lt;Buffer&gt;<br>复制代码<br></code></pre></td></tr></table></figure>

<p><code>Android log</code> 输出量巨大，特别是通信系统的log，因此，Android把log输出到不同的缓冲区中，目前定义了四个log缓冲区：</p>
<table>
<thead>
<tr>
<th align="left">缓冲区</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Radio</td>
<td align="left">输出通信系统的 log</td>
</tr>
<tr>
<td align="left">System</td>
<td align="left">输出系统组件的 log</td>
</tr>
<tr>
<td align="left">Event</td>
<td align="left">输出 event 模块的 log</td>
</tr>
<tr>
<td align="left">Main</td>
<td align="left">所有 java 层的 log 以及不属于上面3层的 log</td>
</tr>
</tbody></table>
<p>缓冲区主要给系统组件使用，一般的应用不需要关心，应用的log都输出到main缓冲区中。默认log输出（不指定缓冲区的情况下）是输出System和Main缓冲区的log。</p>
<h5 id="4-6-1-7-打印指定日志缓冲区的大小"><a href="#4-6-1-7-打印指定日志缓冲区的大小" class="headerlink" title="4.6.1.7 打印指定日志缓冲区的大小"></a>4.6.1.7 打印指定日志缓冲区的大小</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb logcat -g<br>复制代码<br></code></pre></td></tr></table></figure>

<h4 id="4-6-2-内核日志"><a href="#4-6-2-内核日志" class="headerlink" title="4.6.2 内核日志"></a>4.6.2 内核日志</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell dmesg<br>复制代码<br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">&lt;6&gt;[14201.684016] PM: noirq resume of devices complete after 0.982 msecs<br>&lt;6&gt;[14201.685525] PM: early resume of devices complete after 0.838 msecs<br>&lt;6&gt;[14201.753642] PM: resume of devices complete after 68.106 msecs<br>&lt;4&gt;[14201.755954] Restarting tasks ... done.<br>&lt;6&gt;[14201.771229] PM: suspend exit 2016-08-28 13:31:32.679217193 UTC<br>&lt;6&gt;[14201.872373] PM: suspend entry 2016-08-28 13:31:32.780363596 UTC<br>&lt;6&gt;[14201.872498] PM: Syncing filesystems ... done.<br>复制代码<br></code></pre></td></tr></table></figure>

<p>中括号里的 <code>[14201.684016]</code> 代表内核开始启动后的时间，单位为秒。</p>
<p>通过内核日志我们可以做一些事情，比如衡量内核启动时间，在系统启动完毕后的内核日志里找到 <code>Freeing init memory</code> 那一行前面的时间就是。</p>
<h3 id="4-8-查看-Android-设备系统属性"><a href="#4-8-查看-Android-设备系统属性" class="headerlink" title="4.8 查看 Android 设备系统属性"></a>4.8 查看 Android 设备系统属性</h3><p>查看 Android 设备系统属性的基本命令格式是：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> getprop [<span class="hljs-keyword">options</span>]<br></code></pre></td></tr></table></figure>

<p>除了可以查看 Android 设备系统属性之外，还可以设置系统属性，设置系统属性的基本命令格式是：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> setprop <span class="hljs-symbol">&lt;key&gt;</span> <span class="hljs-symbol">&lt;value&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="4-8-1-查看设备型号"><a href="#4-8-1-查看设备型号" class="headerlink" title="4.8.1 查看设备型号"></a>4.8.1 查看设备型号</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> getprop ro.product.model</span><br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">huawei mate 30 pro<br>复制代码<br></code></pre></td></tr></table></figure>

<h4 id="4-8-2-查看设备电池状况"><a href="#4-8-2-查看设备电池状况" class="headerlink" title="4.8.2 查看设备电池状况"></a>4.8.2 查看设备电池状况</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> dumpsys battery</span><br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">Current Battery Service state:<br>  AC powered: false<br>  USB powered: true<br>  Wireless powered: false<br>  status: 2<br>  health: 2<br>  present: true<br>  level: 44<br>  scale: 100<br>  voltage: 3872<br>  temperature: 280<br>  technology: Li-poly<br>复制代码<br></code></pre></td></tr></table></figure>

<p>其中 <code>scale</code> 代表最大电量，<code>level</code> 代表当前电量。上面的输出表示还剩下 44% 的电量。</p>
<h4 id="4-8-3-查看设备屏幕分辨率"><a href="#4-8-3-查看设备屏幕分辨率" class="headerlink" title="4.8.3 查看设备屏幕分辨率"></a>4.8.3 查看设备屏幕分辨率</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">adb shell wm size<br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Physical</span> size: <span class="hljs-number">1080</span>x1920<br></code></pre></td></tr></table></figure>

<p>该设备屏幕分辨率为 1080px * 1920px。</p>
<p>如果使用命令修改过，那输出可能是：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Physical size: 1080x1920<br>Override size: 480x1024<br>复制代码<br></code></pre></td></tr></table></figure>

<p>表明设备的屏幕分辨率原本是 1080px * 1920px，当前被修改为 480px * 1024px。</p>
<h4 id="4-8-4-查看设备屏幕密度"><a href="#4-8-4-查看设备屏幕密度" class="headerlink" title="4.8.4 查看设备屏幕密度"></a>4.8.4 查看设备屏幕密度</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> wm density</span><br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">Physical density: 360<br></code></pre></td></tr></table></figure>

<p>该设备屏幕密度为 360dpi。</p>
<p>如果使用命令修改过，那输出可能是：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Physical</span> density: <span class="hljs-number">420</span><br><span class="hljs-attribute">Override</span> density: <span class="hljs-number">360</span><br></code></pre></td></tr></table></figure>

<p>表明设备的屏幕密度原来是 420dpi，当前被修改为 360dpi。</p>
<h4 id="4-8-5-查看设备显示屏参数"><a href="#4-8-5-查看设备显示屏参数" class="headerlink" title="4.8.5 查看设备显示屏参数"></a>4.8.5 查看设备显示屏参数</h4><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">adb <span class="hljs-built_in">shell</span> dumpsys <span class="hljs-built_in">window</span> displays<br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays)<br>  Display: mDisplayId=0<br>    init=1080x1920 420dpi cur=1080x1920 app=1080x1794 rng=1080x1017-1810x1731<br>    deferred=false layoutNeeded=false<br>复制代码<br></code></pre></td></tr></table></figure>

<p>其中 <code>mDisplayId</code> 为 显示屏编号，<code>init</code> 是初始分辨率和屏幕密度，<code>app</code> 的高度比 <code>init</code> 里的要小，表示屏幕底部有虚拟按键，高度为 1920 - 1794 &#x3D; 126px 合 42dp。</p>
<h4 id="4-8-6-查看设备-android-id"><a href="#4-8-6-查看设备-android-id" class="headerlink" title="4.8.6 查看设备 android_id"></a>4.8.6 查看设备 android_id</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">adb shell<span class="hljs-built_in"> settings </span><span class="hljs-built_in">get</span> secure android_id <br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">5a3a3aa2c3042184<br></code></pre></td></tr></table></figure>

<h4 id="4-8-7-查看设备IMEI"><a href="#4-8-7-查看设备IMEI" class="headerlink" title="4.8.7 查看设备IMEI"></a>4.8.7 查看设备IMEI</h4><p>在 Android 4.4 及以下版本可通过如下命令获取 IMEI：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> dumpsys iphonesubinfo</span><br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">Phone Subscriber Info:<br>  Phone Type = GSM<br>  Device ID = 860955027785041<br></code></pre></td></tr></table></figure>

<p>其中的 <code>Device ID</code> 就是 IMEI。</p>
<p>而在 Android 5.0 及以上版本里这个命令输出为空，得通过其它方式获取了（需要 root 权限）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell<br>su<br>service call iphonesubinfo 1<br></code></pre></td></tr></table></figure>

<p>把里面的有效内容提取出来就是 IMEI 了，比如这里的是 <code>890956027785041</code>。</p>
<p>参考：<a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/27002663/adb-shell-dumpsys-iphonesubinfo-not-working-since-android-5-0-lollipop">adb shell dumpsys iphonesubinfo not working since Android 5.0 Lollipop</a></p>
<h4 id="4-8-8-查看设备-Android-系统版本"><a href="#4-8-8-查看设备-Android-系统版本" class="headerlink" title="4.8.8 查看设备 Android 系统版本"></a>4.8.8 查看设备 Android 系统版本</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">adb <span class="hljs-built_in">shell</span> getprop ro.build.<span class="hljs-built_in">version</span>.release<br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">7.1.2<br></code></pre></td></tr></table></figure>

<h4 id="4-8-9-查看设备-IP-地址"><a href="#4-8-9-查看设备-IP-地址" class="headerlink" title="4.8.9 查看设备 IP 地址"></a>4.8.9 查看设备 IP 地址</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> ifconfig | <span class="hljs-keyword">grep</span> Mask<br></code></pre></td></tr></table></figure>

<p>在有的设备上这个命令没有输出，如果设备连着 WiFi，可以使用如下命令来查看局域网 IP：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> ifconfig wlan0</span><br></code></pre></td></tr></table></figure>

<p>如果以上命令仍然不能得到期望的信息，那可以试试以下命令（部分系统版本里可用）：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> netcfg</span><br></code></pre></td></tr></table></figure>

<h4 id="4-8-10-查看设备-Mac-地址"><a href="#4-8-10-查看设备-Mac-地址" class="headerlink" title="4.8.10 查看设备 Mac 地址"></a>4.8.10 查看设备 Mac 地址</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">adb shell cat <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/net/</span>wlan0/address <br></code></pre></td></tr></table></figure>

<p>输出示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">36:0f:a5:9a:c7:7d<br></code></pre></td></tr></table></figure>

<p>这查看的是局域网 Mac 地址，移动网络或其它连接的信息可以通过前面的小节「IP 地址」里提到的 <code>adb shell netcfg</code> 命令来查看。</p>
<h4 id="4-8-11-查看设备-CPU-信息"><a href="#4-8-11-查看设备-CPU-信息" class="headerlink" title="4.8.11 查看设备 CPU 信息"></a>4.8.11 查看设备 CPU 信息</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> <span class="hljs-built_in">cat</span> /proc/cpuinfo</span><br></code></pre></td></tr></table></figure>

<h4 id="4-8-12-查看设备内存信息"><a href="#4-8-12-查看设备内存信息" class="headerlink" title="4.8.12 查看设备内存信息"></a>4.8.12 查看设备内存信息</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> <span class="hljs-built_in">cat</span> /proc/meminfo</span><br></code></pre></td></tr></table></figure>

<h4 id="4-8-13-查看设备更多硬件与系统属性"><a href="#4-8-13-查看设备更多硬件与系统属性" class="headerlink" title="4.8.13 查看设备更多硬件与系统属性"></a>4.8.13 查看设备更多硬件与系统属性</h4><p>设备的更多硬件与系统属性可以通过如下命令查看：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> <span class="hljs-built_in">cat</span> /system/build.prop</span><br></code></pre></td></tr></table></figure>

<p>这会输出很多信息，包括前面几个小节提到的「型号」和「Android 系统版本」等。</p>
<p>输出里还包括一些其它有用的信息，它们也可通过 <code>adb shell getprop &lt;属性名&gt;</code> 命令单独查看，列举一部分属性如下：</p>
<table>
<thead>
<tr>
<th align="left">属性名</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ro.build.version.sdk</td>
<td align="left">SDK 版本</td>
</tr>
<tr>
<td align="left">ro.build.version.release</td>
<td align="left">Android 系统版本</td>
</tr>
<tr>
<td align="left">ro.build.version.security_patch</td>
<td align="left">Android 安全补丁程序级别</td>
</tr>
<tr>
<td align="left">ro.product.model</td>
<td align="left">型号</td>
</tr>
<tr>
<td align="left">ro.product.brand</td>
<td align="left">品牌</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="http://ro.product.name/">ro.product.name</a></td>
<td align="left">设备名</td>
</tr>
<tr>
<td align="left">ro.product.board</td>
<td align="left">处理器型号</td>
</tr>
<tr>
<td align="left">ro.product.cpu.abilist</td>
<td align="left">CPU 支持的 abi 列表[<em>节注一</em>]</td>
</tr>
<tr>
<td align="left">persist.sys.isUsbOtgEnabled</td>
<td align="left">是否支持 OTG</td>
</tr>
<tr>
<td align="left">dalvik.vm.heapsize</td>
<td align="left">每个应用程序的内存上限</td>
</tr>
<tr>
<td align="left">ro.sf.lcd_density</td>
<td align="left">屏幕密度</td>
</tr>
</tbody></table>
<p><em>节注一：</em></p>
<p>一些小厂定制的 ROM 可能修改过 CPU 支持的 abi 列表的属性名，如果用 <code>ro.product.cpu.abilist</code> 属性名查找不到，可以这样试试：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">cat</span> /<span class="hljs-built_in">system</span>/build.prop | <span class="hljs-keyword">grep</span> ro.product.cpu.abi<br></code></pre></td></tr></table></figure>

<p>示例输出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">ro.product.cpu.abi=armeabi-v7a<br>ro.product.cpu.abi2=armeabi<br></code></pre></td></tr></table></figure>

<h3 id="4-9-修改设置"><a href="#4-9-修改设置" class="headerlink" title="4.9 修改设置"></a>4.9 修改设置</h3><p><strong>注：</strong> 修改设置之后，运行恢复命令有可能显示仍然不太正常，可以运行 <code>adb reboot</code> 重启设备，或手动重启。</p>
<p>修改设置的原理主要是通过 settings 命令修改 &#x2F;data&#x2F;data&#x2F;com.android.providers.settings&#x2F;databases&#x2F;settings.db 里存放的设置值。</p>
<h4 id="4-9-1-修改分辨率"><a href="#4-9-1-修改分辨率" class="headerlink" title="4.9.1 修改分辨率"></a>4.9.1 修改分辨率</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell wm size <span class="hljs-number">480</span>x1024<br></code></pre></td></tr></table></figure>

<p>表示将分辨率修改为 480px * 1024px。</p>
<p>恢复原分辨率命令：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">adb shell wm size reset<br></code></pre></td></tr></table></figure>

<h4 id="4-9-2-修改屏幕密度"><a href="#4-9-2-修改屏幕密度" class="headerlink" title="4.9.2 修改屏幕密度"></a>4.9.2 修改屏幕密度</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell wm density <span class="hljs-number">160</span><br></code></pre></td></tr></table></figure>

<p>表示将屏幕密度修改为 160dpi。</p>
<p>恢复原屏幕密度命令：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> wm density reset</span><br></code></pre></td></tr></table></figure>

<h4 id="4-9-3-修改显示区域"><a href="#4-9-3-修改显示区域" class="headerlink" title="4.9.3 修改显示区域"></a>4.9.3 修改显示区域</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell wm overscan <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">200</span><br></code></pre></td></tr></table></figure>

<p>四个数字分别表示距离左、上、右、下边缘的留白像素，以上命令表示将屏幕底部 200px 留白。</p>
<p>恢复原显示区域命令：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb <span class="hljs-keyword">shell</span><span class="language-bash"> wm overscan reset</span><br></code></pre></td></tr></table></figure>

<h4 id="4-9-4-修改关闭-USB-调试模式"><a href="#4-9-4-修改关闭-USB-调试模式" class="headerlink" title="4.9.4 修改关闭 USB 调试模式"></a>4.9.4 修改关闭 USB 调试模式</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">adb <span class="hljs-built_in">shell</span> settings <span class="hljs-built_in">put</span> <span class="hljs-built_in">global</span> adb_enabled <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>用命令恢复不了了，毕竟关闭了 USB 调试 adb 就连接不上 Android 设备了。 去设备上手动恢复吧：「设置」-「开发者选项」-「Android 调试」。</p>
<h4 id="4-9-5-修改允许-x2F-禁止访问非-SDK-API"><a href="#4-9-5-修改允许-x2F-禁止访问非-SDK-API" class="headerlink" title="4.9.5 修改允许&#x2F;禁止访问非 SDK API"></a>4.9.5 修改允许&#x2F;禁止访问非 SDK API</h4><p>允许访问非 SDK API：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell settings put global hidden_api_policy_pre_p_apps 1<br>adb shell settings put global hidden_api_policy_p_apps 1<br>复制代码<br></code></pre></td></tr></table></figure>

<p>禁止访问非 SDK API：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell settings delete global hidden_api_policy_pre_p_apps<br>adb shell settings delete global hidden_api_policy_p_apps<br>复制代码<br></code></pre></td></tr></table></figure>

<p>不需要设备获得 Root 权限。</p>
<p>命令最后的数字的含义：</p>
<table>
<thead>
<tr>
<th align="left">值</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">禁止检测非 SDK 接口的调用。该情况下，日志记录功能被禁用，并且令 strict mode API，即 detectNonSdkApiUsage() 无效。不推荐。</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">仅警告——允许访问所有非 SDK 接口，但保留日志中的警告信息，可继续使用 strick mode API。</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">禁止调用深灰名单和黑名单中的接口。</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">禁止调用黑名单中的接口，但允许调用深灰名单中的接口。</td>
</tr>
</tbody></table>
<h4 id="4-9-6-修改状态栏和导航栏的显示隐藏"><a href="#4-9-6-修改状态栏和导航栏的显示隐藏" class="headerlink" title="4.9.6 修改状态栏和导航栏的显示隐藏"></a>4.9.6 修改状态栏和导航栏的显示隐藏</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> settings <span class="hljs-keyword">put</span> <span class="hljs-keyword">global</span> policy_control <span class="hljs-symbol">&lt;key-values&gt;</span><br></code></pre></td></tr></table></figure>

<p><code>&lt;key-values&gt;</code> 可由如下几种键及其对应的值组成，格式为 <code>&lt;key1&gt;=&lt;value1&gt;:&lt;key2&gt;=&lt;value2&gt;</code>。</p>
<table>
<thead>
<tr>
<th align="left">key</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">immersive.full</td>
<td align="left">同时隐藏</td>
</tr>
<tr>
<td align="left">immersive.status</td>
<td align="left">隐藏状态栏</td>
</tr>
<tr>
<td align="left">immersive.navigation</td>
<td align="left">隐藏导航栏</td>
</tr>
<tr>
<td align="left">immersive.preconfirms</td>
<td align="left">?</td>
</tr>
</tbody></table>
<p>这些键对应的值可则如下值用逗号组合：</p>
<table>
<thead>
<tr>
<th align="left">value</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>apps</code></td>
<td align="left">所有应用</td>
</tr>
<tr>
<td align="left"><code>*</code></td>
<td align="left">所有界面</td>
</tr>
<tr>
<td align="left"><code>package-name</code></td>
<td align="left">指定应用</td>
</tr>
<tr>
<td align="left"><code>-package-name</code></td>
<td align="left">排除指定应用</td>
</tr>
</tbody></table>
<p>例如：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">adb <span class="hljs-built_in">shell</span> settings <span class="hljs-built_in">put</span> <span class="hljs-built_in">global</span> policy_control immersive.full=*<br></code></pre></td></tr></table></figure>

<p>表示设置在所有界面下都同时隐藏状态栏和导航栏。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> settings <span class="hljs-keyword">put</span> <span class="hljs-keyword">global</span> policy_control immersive.status=<span class="hljs-keyword">com</span>.package1,<span class="hljs-keyword">com</span>.package2:immersive.navigation=apps,-<span class="hljs-keyword">com</span>.package3<br></code></pre></td></tr></table></figure>

<p>表示设置在包名为 <code>com.package1</code> 和 <code>com.package2</code> 的应用里隐藏状态栏，在除了包名为 <code>com.package3</code> 的所有应用里隐藏导航栏。</p>
<h3 id="4-11-实用功能"><a href="#4-11-实用功能" class="headerlink" title="4.11 实用功能"></a>4.11 实用功能</h3><h4 id="4-11-1-屏幕截图"><a href="#4-11-1-屏幕截图" class="headerlink" title="4.11.1 屏幕截图"></a>4.11.1 屏幕截图</h4><p>截图保存到电脑：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">adb <span class="hljs-keyword">exec</span><span class="hljs-operator">-</span><span class="hljs-keyword">out</span> screencap <span class="hljs-operator">-</span>p <span class="hljs-operator">&gt;</span> sc.png<br></code></pre></td></tr></table></figure>

<p>如果 adb 版本较老，无法使用 <code>exec-out</code> 命令，这时候建议更新 adb 版本。无法更新的话可以使用以下麻烦点的办法：</p>
<p>先截图保存到设备里：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb shell screencap -p <span class="hljs-regexp">/sdcard/</span>sc.png<br></code></pre></td></tr></table></figure>

<p>然后将 png 文件导出到电脑：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb pull <span class="hljs-regexp">/sdcard/</span>sc.png<br></code></pre></td></tr></table></figure>

<p>可以使用 <code>adb shell screencap -h</code> 查看 <code>screencap</code> 命令的帮助信息，下面是两个有意义的参数及含义：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-p</td>
<td align="left">指定保存文件为 png 格式</td>
</tr>
<tr>
<td align="left">-d display-id</td>
<td align="left">指定截图的显示屏编号（有多显示屏的情况下）</td>
</tr>
</tbody></table>
<p>实测如果指定文件名以 <code>.png</code> 结尾时可以省略 -p 参数；否则需要使用 -p 参数。如果不指定文件名，截图文件的内容将直接输出到 stdout。</p>
<p>另外一种一行命令截图并保存到电脑的方法： <em>Linux 和 Windows</em></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">adb <span class="hljs-keyword">shell</span> screencap -p | sed <span class="hljs-string">&quot;s/\r$//&quot;</span> &gt; <span class="hljs-keyword">sc</span>.png<br></code></pre></td></tr></table></figure>

<p><em>Mac OS X</em></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">adb <span class="hljs-keyword">shell</span> screencap -p | gsed <span class="hljs-string">&quot;s/\r$//&quot;</span> &gt; <span class="hljs-keyword">sc</span>.png<br></code></pre></td></tr></table></figure>

<p>这个方法需要用到 gnu sed 命令，在 Linux 下直接就有，在 Windows 下 Git 安装目录的 bin 文件夹下也有。如果确实找不到该命令，可以下载 <a target="_blank" rel="noopener" href="http://gnuwin32.sourceforge.net/packages/sed.htm">sed for Windows</a> 并将 sed.exe 所在文件夹添加到 PATH 环境变量里。</p>
<p>而在 Mac 下使用系统自带的 sed 命令会报错：</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-symbol">sed:</span> RE <span class="hljs-keyword">error</span>: illegal <span class="hljs-type">byte</span> sequence<br></code></pre></td></tr></table></figure>

<p>需要安装 gnu-sed，然后使用 gsed 命令：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">brew </span><span class="hljs-keyword">install </span>gnu-sed<br></code></pre></td></tr></table></figure>

<h4 id="4-11-2-录制屏幕"><a href="#4-11-2-录制屏幕" class="headerlink" title="4.11.2 录制屏幕"></a>4.11.2 录制屏幕</h4><p>录制屏幕以 mp4 格式保存到 &#x2F;sdcard：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb shell screenrecord <span class="hljs-regexp">/sdcard/</span>filename.mp4<br></code></pre></td></tr></table></figure>

<p>需要停止时按 Ctrl-C，默认录制时间和最长录制时间都是 180 秒。</p>
<p>如果需要导出到电脑：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb pull <span class="hljs-regexp">/sdcard/</span>filename.mp4<br></code></pre></td></tr></table></figure>

<p>可以使用 <code>adb shell screenrecord --help</code> 查看 <code>screenrecord</code> 命令的帮助信息，下面是常见参数及含义：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">–size WIDTHxHEIGHT</td>
<td align="left">视频的尺寸，比如 <code>1280x720</code>，默认是屏幕分辨率。</td>
</tr>
<tr>
<td align="left">–bit-rate RATE</td>
<td align="left">视频的比特率，默认是 4Mbps。</td>
</tr>
<tr>
<td align="left">–time-limit TIME</td>
<td align="left">录制时长，单位秒。</td>
</tr>
<tr>
<td align="left">–verbose</td>
<td align="left">输出更多信息。</td>
</tr>
</tbody></table>
<h4 id="4-11-3-查看连接过的-WiFi-密码"><a href="#4-11-3-查看连接过的-WiFi-密码" class="headerlink" title="4.11.3 查看连接过的 WiFi 密码"></a>4.11.3 查看连接过的 WiFi 密码</h4><p><strong>注：需要 root 权限。</strong></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">adb shell<br>su<br>cat <span class="hljs-regexp">/data/mi</span>sc<span class="hljs-regexp">/wifi/</span>*.conf<br></code></pre></td></tr></table></figure>

<h4 id="4-11-4-设置系统日期和时间"><a href="#4-11-4-设置系统日期和时间" class="headerlink" title="4.11.4 设置系统日期和时间"></a>4.11.4 设置系统日期和时间</h4><p><strong>注：需要 root 权限。</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell<br><span class="hljs-attribute">su</span><br><span class="hljs-attribute">date</span> -s <span class="hljs-number">20160823</span>.<span class="hljs-number">131500</span><br></code></pre></td></tr></table></figure>

<p>表示将系统日期和时间更改为 2016 年 08 月 23 日 13 点 15 分 00 秒。</p>
<h4 id="4-11-5-重启手机"><a href="#4-11-5-重启手机" class="headerlink" title="4.11.5 重启手机"></a>4.11.5 重启手机</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adb reboot</span><br></code></pre></td></tr></table></figure>

<h4 id="4-11-6-检测设备是否已-root"><a href="#4-11-6-检测设备是否已-root" class="headerlink" title="4.11.6 检测设备是否已 root"></a>4.11.6 检测设备是否已 root</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">adb <span class="hljs-keyword">shell</span><br><span class="hljs-keyword">su</span><br></code></pre></td></tr></table></figure>

<p>此时命令行提示符是 <code>$</code> 则表示没有 root 权限，是 <code>#</code> 则表示已 root。</p>
<h4 id="4-11-7-使用-Monkey-进行压力测试"><a href="#4-11-7-使用-Monkey-进行压力测试" class="headerlink" title="4.11.7 使用 Monkey 进行压力测试"></a>4.11.7 使用 Monkey 进行压力测试</h4><p>Monkey 可以生成伪随机用户事件来模拟单击、触摸、手势等操作，可以对正在开发中的程序进行随机压力测试。</p>
<p>简单用法：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> monkey -<span class="hljs-keyword">p</span> <span class="hljs-symbol">&lt;packagename&gt;</span> -v <span class="hljs-number">500</span><br></code></pre></td></tr></table></figure>

<p>表示向 <code>&lt;packagename&gt;</code> 指定的应用程序发送 500 个伪随机事件。 Monkey 的详细用法参考 <a target="_blank" rel="noopener" href="https://developer.android.com/studio/test/monkey.html">官方文档</a>。</p>
<h4 id="4-11-8-开启-x2F-关闭-WiFi"><a href="#4-11-8-开启-x2F-关闭-WiFi" class="headerlink" title="4.11.8 开启&#x2F;关闭 WiFi"></a>4.11.8 开启&#x2F;关闭 WiFi</h4><p><strong>注：需要 root 权限。</strong></p>
<ul>
<li>开启 WiFi：</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb root<br>adb <span class="hljs-keyword">shell</span><span class="language-bash"> svc wifi <span class="hljs-built_in">enable</span></span><br></code></pre></td></tr></table></figure>

<ul>
<li>关闭 WiFi：</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">adb root<br>adb <span class="hljs-keyword">shell</span><span class="language-bash"> svc wifi <span class="hljs-built_in">disable</span></span><br></code></pre></td></tr></table></figure>

<p>若执行成功，输出为空；若未取得 root 权限执行此命令，将执行失败，输出 <code>Killed</code>。</p>
<h3 id="4-12-安全相关命令"><a href="#4-12-安全相关命令" class="headerlink" title="4.12 安全相关命令"></a>4.12 安全相关命令</h3><h4 id="4-12-1-启用-x2F-禁用-SELinux"><a href="#4-12-1-启用-x2F-禁用-SELinux" class="headerlink" title="4.12.1 启用&#x2F;禁用 SELinux"></a>4.12.1 启用&#x2F;禁用 SELinux</h4><p>启用 SELinux</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> root<br><span class="hljs-attribute">adb</span> shell setenforce <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>禁用 SELinux</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> root<br><span class="hljs-attribute">adb</span> shell setenforce <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<h4 id="4-12-2-启用-x2F-禁用-dm-verity"><a href="#4-12-2-启用-x2F-禁用-dm-verity" class="headerlink" title="4.12.2 启用&#x2F;禁用 dm_verity"></a>4.12.2 启用&#x2F;禁用 dm_verity</h4><p>启用 dm_verity</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adb root</span><br><span class="hljs-attribute">adb enable-verity</span><br></code></pre></td></tr></table></figure>

<p>禁用 dm_verity</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adb root</span><br><span class="hljs-attribute">adb disable-verity</span><br></code></pre></td></tr></table></figure>

<h3 id="4-13-更多-adb-shell-命令"><a href="#4-13-更多-adb-shell-命令" class="headerlink" title="4.13 更多 adb shell 命令"></a>4.13 更多 adb shell 命令</h3><p>Android 系统是基于 Linux 内核的，所以 Linux 里的很多命令在 Android 里也有相同或类似的实现，在 <code>adb shell</code> 里可以调用。本文档前面的部分内容已经用到了 <code>adb shell</code> 命令。</p>
<h4 id="4-14-1-查看进程状态"><a href="#4-14-1-查看进程状态" class="headerlink" title="4.14.1 查看进程状态"></a>4.14.1 查看进程状态</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> <span class="hljs-keyword">ps</span><br></code></pre></td></tr></table></figure>

<p>输出信息各列含义：</p>
<table>
<thead>
<tr>
<th align="left">列名</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">USER</td>
<td align="left">所属用户</td>
</tr>
<tr>
<td align="left">PID</td>
<td align="left">进程 ID</td>
</tr>
<tr>
<td align="left">PPID</td>
<td align="left">父进程 ID</td>
</tr>
<tr>
<td align="left">NAME</td>
<td align="left">进程名</td>
</tr>
</tbody></table>
<h4 id="4-14-2-查看处理器实时状态"><a href="#4-14-2-查看处理器实时状态" class="headerlink" title="4.14.2 查看处理器实时状态"></a>4.14.2 查看处理器实时状态</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">adb shell <span class="hljs-attribute">top</span> <span class="hljs-selector-attr">[-m max_procs]</span> <span class="hljs-selector-attr">[-n iterations]</span> <span class="hljs-selector-attr">[-d delay]</span> <span class="hljs-selector-attr">[-s sort_column]</span> <span class="hljs-selector-attr">[-t]</span> <span class="hljs-selector-attr">[-h]</span><br></code></pre></td></tr></table></figure>

<p><code>adb shell top</code> 后面可以跟一些可选参数进行过滤查看不同的列表，可用参数及含义如下：</p>
<table>
<thead>
<tr>
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-m</td>
<td align="left">最多显示多少个进程</td>
</tr>
<tr>
<td align="left">-n</td>
<td align="left">刷新多少次后退出</td>
</tr>
<tr>
<td align="left">-d</td>
<td align="left">刷新时间间隔(单位秒，默认值5)</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">按某列排序(可用col值：cpu, vss, rss, thr)</td>
</tr>
<tr>
<td align="left">-t</td>
<td align="left">显示线程信息</td>
</tr>
<tr>
<td align="left">-h</td>
<td align="left">显示帮助文档</td>
</tr>
</tbody></table>
<p>输出信息各列含义：</p>
<table>
<thead>
<tr>
<th align="left">列名</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">PID</td>
<td align="left">进程 ID</td>
</tr>
<tr>
<td align="left">PR</td>
<td align="left">优先级</td>
</tr>
<tr>
<td align="left">CPU%</td>
<td align="left">当前瞬间占用 CPU 百分比</td>
</tr>
<tr>
<td align="left">S</td>
<td align="left">进程状态（R&#x3D;运行，S&#x3D;睡眠，T&#x3D;跟踪&#x2F;停止，Z&#x3D;僵尸进程）</td>
</tr>
<tr>
<td align="left">#THR</td>
<td align="left">线程数</td>
</tr>
<tr>
<td align="left">VSS</td>
<td align="left">Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）</td>
</tr>
<tr>
<td align="left">RSS</td>
<td align="left">Resident Set Size 实际使用物理内存（包含共享库占用的内存）</td>
</tr>
<tr>
<td align="left">PCY</td>
<td align="left">调度策略优先级，SP_BACKGROUND&#x2F;SPFOREGROUND</td>
</tr>
<tr>
<td align="left">UID</td>
<td align="left">进程所有者的用户 ID</td>
</tr>
<tr>
<td align="left">NAME</td>
<td align="left">进程名</td>
</tr>
</tbody></table>
<h4 id="4-14-3-查看进程-UID"><a href="#4-14-3-查看进程-UID" class="headerlink" title="4.14.3 查看进程 UID"></a>4.14.3 查看进程 UID</h4><p>有两种方案：</p>
<p>方案一：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">adb <span class="hljs-keyword">shell</span> dumpsys package <span class="hljs-symbol">&lt;packagename&gt;</span> | <span class="hljs-keyword">grep</span> userId= 如：<br> adb <span class="hljs-keyword">shell</span> dumpsys package org.mazhuang.guanggoo | <span class="hljs-keyword">grep</span> userId=<br>  userId=<span class="hljs-number">10394</span><br></code></pre></td></tr></table></figure>

<p>方案二：</p>
<p>通过 ps 命令找到对应进程的 pid 之后 <code>adb shell cat /proc/&lt;pid&gt;/status | grep Uid</code> 如：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">adb</span> shell<br><span class="hljs-attribute">gemini</span>:/ $ ps | grep org.mazhuang.guanggoo<br><span class="hljs-attribute">u0_a394</span>   <span class="hljs-number">28635</span> <span class="hljs-number">770</span>   <span class="hljs-number">1795812</span> <span class="hljs-number">78736</span> SyS_epoll_ <span class="hljs-number">0000000000</span> S org.mazhuang.guanggoo<br><span class="hljs-attribute">gemini</span>:/ $ cat /proc/<span class="hljs-number">28635</span>/status | grep Uid<br><span class="hljs-attribute">Uid</span>:    <span class="hljs-number">10394</span>   <span class="hljs-number">10394</span>   <span class="hljs-number">10394</span>   <span class="hljs-number">10394</span><br><span class="hljs-attribute">gemini</span>:/ $<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%B7%A5%E5%85%B7%E7%9F%A5%E8%AF%86/" class="category-chain-item">工具知识</a>
  
  
    <span>></span>
    
  <a href="/categories/%E5%B7%A5%E5%85%B7%E7%9F%A5%E8%AF%86/adb/" class="category-chain-item">adb</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/adb/">#adb</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>adb基本命令</div>
      <div>https://tangerine-kitten-lux.netlify.app/adb基本命令/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>lux</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年10月24日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Android%20%E4%B8%AD%E5%AE%9E%E7%8E%B0IPC-1/" title="IPC基础知识">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">IPC基础知识</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/CameraX%E5%AE%9E%E6%97%B6%E9%A2%84%E8%A7%88-%E6%8B%8D%E7%85%A7/" title="CameraX实时预览+拍照">
                        <span class="hidden-mobile">CameraX实时预览+拍照</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/caidai.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/boom.js"></script>
<script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/love.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="/js/model.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
